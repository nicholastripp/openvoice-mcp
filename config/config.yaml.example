# Home Assistant Realtime Voice Assistant Configuration

# OpenAI Configuration
openai:
  api_key: ${OPENAI_API_KEY}        # From environment variable
  voice: "alloy"                    # alloy, ash, ballad, coral, echo, sage, shimmer, verse
  model: "gpt-4o-realtime-preview"  # OpenAI Realtime model
  temperature: 0.8                  # Response creativity (0.0-1.0)
  language: "en"                    # Language code (en, es, fr, de, etc.)
  
# Home Assistant Configuration  
home_assistant:
  url: "http://homeassistant.local:8123"  # Your HA instance URL
  token: ${HA_TOKEN}                      # Long-lived access token
  language: "en"                          # Must match OpenAI language
  timeout: 10                             # API timeout in seconds
  
# Audio Configuration
audio:
  input_device: "default"           # Microphone device (name or index)
  output_device: "default"          # Speaker device (name or index)
  sample_rate: 48000               # Device sample rate (48000, 44100, etc.)
  channels: 1                      # Audio channels (1=mono, 2=stereo)
  chunk_size: 1200                 # Audio chunk size (50ms at 24kHz)
  input_volume: 5.0                # Input volume multiplier
  output_volume: 2.0               # Output volume multiplier
  feedback_prevention: true        # Enable audio feedback prevention
  feedback_threshold: 0.1          # Feedback detection threshold
  mute_during_response: true       # Mute microphone during response playback
  
# Wake Word Configuration
wake_word:
  enabled: true                   # Enable wake word detection
  engine: "porcupine"             # Wake word engine: "openwakeword" or "porcupine"
  model: "picovoice"              # Wake word model (see below for options per engine)
  sensitivity: 1.0                # Detection sensitivity (0.0-1.0)
                                  # For Porcupine: 1.0 = maximum sensitivity (recommended)
                                  # For OpenWakeWord: 0.5-0.7 typical, lower = fewer false positives
  timeout: 5.0                    # Session timeout after wake word (seconds)
  vad_enabled: false              # Disable VAD (was causing 0.0 predictions)
  cooldown: 2.0                   # Seconds between wake word detections
  test_mode: false                # Normal operation mode
  audio_gain: 1.0                 # Audio amplification factor (1.0-5.0, default: 1.0)
  audio_gain_mode: "fixed"        # Gain mode: "fixed" or "dynamic"
  
  # Porcupine-specific configuration
  porcupine_access_key: ${PICOVOICE_ACCESS_KEY}  # From environment variable
  highpass_filter_enabled: false  # High-pass filter (false = better detection, true = less noise)
  highpass_filter_cutoff: 50.0    # Filter cutoff frequency in Hz (if enabled)
  
  # Available models per engine:
  # OpenWakeWord: hey_jarvis, alexa, hey_mycroft, hey_rhasspy, ok_nabu
  # 
  # Porcupine built-in keywords (use these exact names in 'model' field):
  #   Known working: alexa, picovoice, computer, americano, blueberry, 
  #                  bumblebee, grapefruit, grasshopper, porcupine, terminator
  #   Aliases: hey_picovoice, ok_picovoice (both map to 'picovoice')
  # 
  # IMPORTANT: 'jarvis' and 'hey_jarvis' are NOT built-in keywords!
  # For custom wake words like 'jarvis', create them at https://console.picovoice.ai/
  # Custom models require downloading the .ppn file and using keyword_paths instead
  
# Session Configuration
session:
  timeout: 30                     # Session timeout in seconds
  auto_end_silence: 3.0          # End session after silence (seconds)
  max_duration: 300              # Maximum session duration (seconds)
  interrupt_threshold: 0.5       # Voice activity to interrupt AI
  auto_end_after_response: true  # Auto-end session after response completion
  response_cooldown_delay: 2.0   # Cooldown delay before ending session (seconds)
  
  # Multi-turn conversation settings
  conversation_mode: "multi_turn"  # "single_turn" or "multi_turn"
  multi_turn_timeout: 30.0         # Seconds to wait for follow-up questions
  multi_turn_max_turns: 10         # Maximum conversation turns per session
  multi_turn_end_phrases:          # Phrases to end multi-turn conversation
    - "goodbye"
    - "stop"
    - "that's all"
    - "thank you"
    - "bye"
  
# System Configuration
system:
  log_level: "INFO"              # DEBUG, INFO, WARNING, ERROR, CRITICAL
  log_file: "logs/assistant.log" # Log file path
  led_gpio: null                 # GPIO pin for status LED (optional)
  daemon: false                  # Run as daemon process
  
# Advanced Configuration
advanced:
  reconnect_delay: 5.0          # WebSocket reconnection delay
  max_reconnect_attempts: 10    # Maximum reconnection attempts
  audio_buffer_size: 8192       # Audio buffer size in bytes
  cost_tracking: true           # Track API usage costs
  debug_audio: false            # Save debug audio files